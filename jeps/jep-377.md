JEP 377: ZGC: A Scalable Low-Latency Garbage Collector (Production)
======================================================================

| Owner | Per Liden | 
| Type | Feature | 
| Scope | Implementation | 
| Status | Closed / Delivered | 
| Release | 15 | 
| Component | hotspot / gc | 
| Discussion | hotspot dash gc dash dev at openjdk dot java dot net | 
| Relates to | JEP 351: ZGC: Uncommit Unused Memory (Experimental)](351) | 
|  | JEP 333: ZGC: A Scalable Low-Latency Garbage Collector (Experimental)](333) | 
|  | JEP 364: ZGC on macOS (Experimental)](364) | 
|  | JEP 365: ZGC on Windows (Experimental)](365) | 
|  | JEP 439: Generational ZGC](439) | 
| Reviewed by | Erik Österlund, Mikael Vidstedt, Stefan Karlsson | 
| Endorsed by | Mikael Vidstedt | 
| Created | 2018/08/20 06:16 | 
| Updated | 2023/03/06 23:17 | 
| Issue | 8209683](https://bugs.openjdk.org/browse/JDK-8209683) | 

## Summary

Change the Z Garbage Collector from an experimental feature into a product feature.

## Non-Goals

This JEP does not propose to change the default GC, which remains G1.

## Motivation

ZGC was integrated into JDK 11 byJEP 333](https://openjdk.java.net/jeps/333). New features of such size and complexity are best introduced carefully and gradually, so we made it an experimental feature. This helped set user expectations and allowed users to provide feedback without having to download or build a separate JDK binary, which would have been the case if ZGC development had continued outside of the JDK.

Since its introduction in JDK 11 we’ve received positive feedback, we’ve ironed out many bugs, and we’ve added a number of features and enhancements. To highlight some of the more important ones:

- Concurrent class unloading
- Uncommitting unused memory (JEP 351](https://openjdk.java.net/jeps/351))
- Maximum heap size increased from 4TB to 16TB
- Minimum heap size decreased to 8MB
- `-XX:SoftMaxHeapSize`
- Support for the JFR leak profiler
- Support for class-data sharing
- Limited and discontiguous address spaces
- Support for placing the heap on NVRAM
- Improved NUMA awareness
- Multi-threaded heap pre-touching

Furthermore, all commonly used platforms are now supported:

- Linux/x86_64 (JEP 333](https://openjdk.java.net/jeps/333))
- Linux/aarch64 (8214527](https://bugs.openjdk.java.net/browse/JDK-8214527))
- Windows (JEP 365](https://openjdk.java.net/jeps/365))
- macOS (JEP 364](https://openjdk.java.net/jeps/364))

Testing of ZGC suggests that it is stable and, as of this writing, we have received no new ZGC-specific bugs for a few months. With the stability, feature set, and platform support that ZGC has today, it is time to remove its experimental status and make it a product feature.

## Description

ZGC is enabled today via the`-XX:+UnlockExperimentalVMOptions -XX:+UseZGC`command-line options. Making ZGC a product (non-experimental) feature means that the`-XX:+UnlockExperimentalVMOptions`option will no longer be needed.

Turning ZGC into a product (non-experimental) feature is mainly a matter of changing the`UseZGC`command-line option type from`experimental`to`product`. In addition, we will also change the following ZGC-specific options, currently marked`experimental`, to`product`. We will not change the default values for these options.

```
ZAllocationSpikeTolerance
ZCollectionInterval
ZFragmentationLimit
ZMarkStackSpaceLimit
ZProactive
ZUncommit
ZUncommitDelay
```

The following ZGC-specific JFR events, currently marked`experimental`, will also be changed to`product`.

```
ZAllocationStall
ZPageAllocation
ZPageCacheFlush
ZRelocationSet
ZRelocationSetGroup
ZUncommit
```

## Testing

Testing of ZGC was added as part ofJEP 333](https://openjdk.java.net/jeps/333), and additional tests have been added since then. No additional tests will be developed as part of this JEP.

Some tests currently supply the`-XX:+UnlockExperimentalVMOptions`command-line option when enabling ZGC. This will no longer be needed, and these tests will be adjusted accordingly.